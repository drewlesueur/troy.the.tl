<!doctype html>
<html>
<head>
<link href='http://fonts.googleapis.com/css?family=Josefin+Sans' rel='stylesheet' type='text/css'>
<link rel="stylesheet/less" type="text/css" href="styles.less">
<style>
  body {
    /*background-color: rgb(39,39,39);
    background-image: -webkit-gradient(radial, 500 25%, 20, 500 25%, 40, from(#000), to(rgb(39,39,39)));
    */
    

  }  
</style>
<script src="http://inc.the.tl/less.js" type="text/javascript"></script>
<script src="http://inc.the.tl/jquery.js"></script>
<script src="http://inc.the.tl/zepto/src/zepto.js"></script>
<script src="http://inc.the.tl/zepto/src/event.js"></script>
<script src="http://inc.the.tl/zepto/src/fx.js"></script>
<script>
  $ = jQuery;
  z = Zepto;
</script>
<script src="http://inc.the.tl/jqueryui.js"></script>
<script src="http://inc.the.tl/underscore.js"></script>
<script src="http://inc.the.tl/coffeescript.js"></script>
<script src="http://inc.the.tl/k/index.js"></script>

<script type="text/coffeescript">
  #problem. instantiating should NOT append to the dom or the object
  $(document).ready () ->
    #trying the Model View Presenter pattern

    #this is a rusty model... polish it. look to backbone as an example
    HomeModel = k.class
      initialize: (e) ->
      loadGalleries: (e) ->
        console.log "fetching"
        $.ajax
          type: "GET"
          url: "http://troybrinkerhoff.com/new2/galleries.php"
          dataType: "jsonp"
          success: (data) ->
            k(e).set "galleries": data 
            
    HomePresenter = k.class
      initialize: (e) ->
        e.model = k.new HomeModel
        model = e.model
        e.view = k.new HomeView
        view = e.view

        k(model).bind "change:galleries", (e) ->
          p(view).clearNavLinks()
          for gallery, info of model.galleries
            p(view).addNavLink k.capitalize(k(gallery).s("gallery_".length)), "#"
          
        k(view).bind "link", (e, linkName) ->
        
        p(model).loadGalleries()

    HomeView = k.class
      #jquert binds and triggers can go in here
      initialize: (e, presenter) ->
        e.presenter = presenter 
        e.el = $('#home-wrapper')
      clearNavLinks: (e) ->
        e.el.find("#links").empty()
      addNavLink: (e, linkName, linkAddress) ->
        a = $ "<a href='#'>#{linkName}</a>"
        a.bind "click", (event) ->
          k(e).trigger "link", linkName
          
        e.el.find("#links").append a
        
    

    home = k.new HomePresenter
    
    return


    
</script>
</head>
<body>
  <div id="wrapper" align="center">
    <div id="home-wrapper">
      <div id="home-image"></div>
      <div id="slide"></div>
      <div id="thumbs"></div>

      <div id="banner">
        <span id="main-logo">Troy Brinkerhoff</span>
        <div id="links">
        </div>
      </div>  
    </div>
  </div>
</body>
</html>
